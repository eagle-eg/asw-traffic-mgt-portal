const licenseData = {
    driving: {
        "رخصة قيادة خاصة": {
            en: [
                "Fill out application form 256.",
                "Provide valid national ID or passport + copy.",
                "Submit 3 personal photos.",
                "Provide original educational qualification + copy.",
                "Medical examination at the traffic unit.",
                "Pass theoretical driving test.",
                "Pass practical driving test.",
                "Pay fees and taxes."
            ],
            ar: [
                "تعبئة نموذج الطلب 256.",
                "تقديم بطاقة الرقم القومي أو جواز السفر + صورة.",
                "تقديم 3 صور شخصية.",
                "تقديم المؤهل الدراسي الأصلي + صورة.",
                "الكشف الطبي داخل الوحدة.",
                "اجتياز اختبار القيادة النظري.",
                "اجتياز اختبار القيادة العملي.",
                "سداد الرسوم والضرائب."
            ]
        },
        "رخصة قيادة دراجة نارية": {
            en: [
                "Fill out application form 256 for motorcycle license.",
                "Provide valid national ID or passport + copy.",
                "Submit 2 personal photos.",
                "Medical examination at the traffic unit.",
                "Pass motorcycle theoretical test.",
                "Pass motorcycle practical test.",
                "Pay fees and taxes."
            ],
            ar: [
                "تعبئة نموذج الطلب 256 لرخصة الدراجة النارية.",
                "تقديم بطاقة الرقم القومي أو جواز السفر + صورة.",
                "تقديم صورتين شخصيتين.",
                "الكشف الطبي داخل الوحدة.",
                "اجتياز اختبار القيادة النظري للدراجة النارية.",
                "اجتياز اختبار القيادة العملي للدراجة النارية.",
                "سداد الرسوم والضرائب."
            ]
        },
        "رخصة قيادة مهنية ثالثة": {
            en: [
                "Fill out professional driving license application.",
                "Provide valid national ID or passport + copy.",
                "Submit 4 personal photos.",
                "Provide professional qualification certificate.",
                "Medical examination at the traffic unit.",
                "Pass professional driving tests.",
                "Pay fees and taxes."
            ],
            ar: [
                "تعبئة طلب رخصة القيادة المهنية.",
                "تقديم بطاقة الرقم القومي أو جواز السفر + صورة.",
                "تقديم 4 صور شخصية.",
                "تقديم شهادة المؤهل المهني.",
                "الكشف الطبي داخل الوحدة.",
                "اجتياز اختبارات القيادة المهنية.",
                "سداد الرسوم والضرائب."
            ]
        }
    },
    vehicle: {
        "ملاكي": {
            en: [
                "Fill out application form 251 for private vehicle.",
                "Provide valid national ID or passport + copy.",
                "Provide ownership documents (certificate of origin or customs release).",
                "Submit file and folder.",
                "Pass technical inspection (every 3 years).",
                "Pay fees and taxes."
            ],
            ar: [
                "تعبئة نموذج الطلب 251 للمركبة الملاكي.",
                "تقديم بطاقة الرقم القومي أو جواز السفر + صورة.",
                "تقديم مستندات الملكية (شهادة المنشأ أو الإفراج الجمركي).",
                "تقديم ملف وحافظة.",
                "اجتياز الفحص الفني (كل 3 سنوات).",
                "سداد الرسوم والضرائب."
            ]
        },
        "دراجة نارية": {
            en: [
                "Fill out application form 251 for motorcycle.",
                "Provide valid national ID or passport + copy.",
                "Provide ownership documents.",
                "Submit file and folder.",
                "Pass technical inspection.",
                "Pay fees and taxes."
            ],
            ar: [
                "تعبئة نموذج الطلب 251 للدراجة النارية.",
                "تقديم بطاقة الرقم القومي أو جواز السفر + صورة.",
                "تقديم مستندات الملكية.",
                "تقديم ملف وحافظة.",
                "اجتياز الفحص الفني.",
                "سداد الرسوم والضرائب."
            ]
        },
        "توك توك": {
            en: [
                "Fill out application form 251 for tuk-tuk.",
                "Provide valid national ID or passport + copy.",
                "Provide ownership documents.",
                "Submit file and folder.",
                "Pass technical inspection.",
                "Pay fees and taxes."
            ],
            ar: [
                "تعبئة نموذج الطلب 251 للتوك توك.",
                "تقديم بطاقة الرقم القومي أو جواز السفر + صورة.",
                "تقديم مستندات الملكية.",
                "تقديم ملف وحافظة.",
                "اجتياز الفحص الفني.",
                "سداد الرسوم والضرائب."
            ]
        },
        "جرار زراعي": {
            en: [
                "Fill out application form 251 for agricultural tractor.",
                "Provide valid national ID or passport + copy.",
                "Provide ownership documents.",
                "Submit file and folder.",
                "Pass technical inspection.",
                "Pay fees and taxes."
            ],
            ar: [
                "تعبئة نموذج الطلب 251 للجرار الزراعي.",
                "تقديم بطاقة الرقم القومي أو جواز السفر + صورة.",
                "تقديم مستندات الملكية.",
                "تقديم ملف وحافظة.",
                "اجتياز الفحص الفني.",
                "سداد الرسوم والضرائب."
            ]
        },
        "مركبة (نقل \\ مقطورة)": {
            en: [
                "Fill out application form 251 for transport vehicle or trailer.",
                "Provide valid national ID or passport + copy.",
                "Provide ownership documents.",
                "Submit file and folder.",
                "Pass technical inspection.",
                "Pay fees and taxes."
            ],
            ar: [
                "تعبئة نموذج الطلب 251 لمركبة نقل أو مقطورة.",
                "تقديم بطاقة الرقم القومي أو جواز السفر + صورة.",
                "تقديم مستندات الملكية.",
                "تقديم ملف وحافظة.",
                "اجتياز الفحص الفني.",
                "سداد الرسوم والضرائب."
            ]
        },
        "أجرة": {
            en: [
                "Fill out application form 251 for taxi.",
                "Provide valid national ID or passport + copy.",
                "Provide ownership documents.",
                "Submit file and folder.",
                "Pass technical inspection.",
                "Pay fees and taxes."
            ],
            ar: [
                "تعبئة نموذج الطلب 251 للأجرة.",
                "تقديم بطاقة الرقم القومي أو جواز السفر + صورة.",
                "تقديم مستندات الملكية.",
                "تقديم ملف وحافظة.",
                "اجتياز الفحص الفني.",
                "سداد الرسوم والضرائب."
            ]
        },
        "اتوبيس خاص": {
            en: [
                "Fill out application form 251 for private bus.",
                "Provide valid national ID or passport + copy.",
                "Provide ownership documents.",
                "Submit file and folder.",
                "Pass technical inspection.",
                "Pay fees and taxes."
            ],
            ar: [
                "تعبئة نموذج الطلب 251 للأتوبيس الخاص.",
                "تقديم بطاقة الرقم القومي أو جواز السفر + صورة.",
                "تقديم مستندات الملكية.",
                "تقديم ملف وحافظة.",
                "اجتياز الفحص الفني.",
                "سداد الرسوم والضرائب."
            ]
        },
        "اتوبيس عام": {
            en: [
                "Fill out application form 251 for public bus.",
                "Provide valid national ID or passport + copy.",
                "Provide ownership documents.",
                "Submit file and folder.",
                "Pass technical inspection.",
                "Pay fees and taxes."
            ],
            ar: [
                "تعبئة نموذج الطلب 251 للأتوبيس العام.",
                "تقديم بطاقة الرقم القومي أو جواز السفر + صورة.",
                "تقديم مستندات الملكية.",
                "تقديم ملف وحافظة.",
                "اجتياز الفحص الفني.",
                "سداد الرسوم والضرائب."
            ]
        },
        "أتوبيس مدارس": {
            en: [
                "Fill out application form 251 for school bus.",
                "Provide valid national ID or passport + copy.",
                "Provide ownership documents.",
                "Submit file and folder.",
                "Pass technical inspection.",
                "Pay fees and taxes."
            ],
            ar: [
                "تعبئة نموذج الطلب 251 لأتوبيس المدارس.",
                "تقديم بطاقة الرقم القومي أو جواز السفر + صورة.",
                "تقديم مستندات الملكية.",
                "تقديم ملف وحافظة.",
                "اجتياز الفحص الفني.",
                "سداد الرسوم والضرائب."
            ]
        },
        "أتوبيس سياحة (ليموزين / أتوبيس)": {
            en: [
                "Fill out application form 251 for tourism bus or limousine.",
                "Provide valid national ID or passport + copy.",
                "Provide ownership documents.",
                "Submit file and folder.",
                "Pass technical inspection.",
                "Pay fees and taxes."
            ],
            ar: [
                "تعبئة نموذج الطلب 251 لأتوبيس السياحة أو الليموزين.",
                "تقديم بطاقة الرقم القومي أو جواز السفر + صورة.",
                "تقديم مستندات الملكية.",
                "تقديم ملف وحافظة.",
                "اجتياز الفحص الفني.",
                "سداد الرسوم والضرائب."
            ]
        },
        "اتوبيس رحلات": {
            en: [
                "Fill out application form 251 for trip bus.",
                "Provide valid national ID or passport + copy.",
                "Provide ownership documents.",
                "Submit file and folder.",
                "Pass technical inspection.",
                "Pay fees and taxes."
            ],
            ar: [
                "تعبئة نموذج الطلب 251 لأتوبيس الرحلات.",
                "تقديم بطاقة الرقم القومي أو جواز السفر + صورة.",
                "تقديم مستندات الملكية.",
                "تقديم ملف وحافظة.",
                "اجتياز الفحص الفني.",
                "سداد الرسوم والضرائب."
            ]
        },
        "مركبة تحت الطلب (تكريم الموتي)": {
            en: [
                "Fill out application form 251 for special request vehicle.",
                "Provide valid national ID or passport + copy.",
                "Provide ownership documents.",
                "Submit file and folder.",
                "Pass technical inspection.",
                "Pay fees and taxes."
            ],
            ar: [
                "تعبئة نموذج الطلب 251 للمركبة تحت الطلب (تكريم الموتى).",
                "تقديم بطاقة الرقم القومي أو جواز السفر + صورة.",
                "تقديم مستندات الملكية.",
                "تقديم ملف وحافظة.",
                "اجتياز الفحص الفني.",
                "سداد الرسوم والضرائب."
            ]
        }
    }
};

// --------------------------------------------------------------------------------------------------------


const categorySelection = document.getElementById("category-selection");
const typeSelection = document.getElementById("type-selection");
const typeList = document.getElementById("type-list");
const typeSelectionTitle = document.getElementById("type-selection-title");
const btnBackToCategory = document.getElementById("btnBackToCategory");
const btnBackToHome = document.getElementById("backHomeBtn");
const stepsModal = new bootstrap.Modal(document.getElementById("stepsModal"));
const stepsModalLabel = document.getElementById("stepsModalLabel");
const stepsModalBody = document.getElementById("stepsModalBody");
const printStepsBtn = document.getElementById("printStepsBtn");

let currentLang = localStorage.getItem("currentLang") || "en";

function clearTypeList() {
    typeList.innerHTML = "";
}

function createTypeCard(typeName) {
    const col = document.createElement("div");
    col.className = "col-12 col-md-6 col-lg-4";

    const card = document.createElement("button");
    card.className = "btn btn-outline-secondary w-100 py-3";
    card.textContent = typeName;
    card.addEventListener("click", () => openStepsModal(typeName));

    col.appendChild(card);
    return col;
}

function openStepsModal(typeName) {
    stepsModalLabel.textContent = typeName;
    stepsModalBody.innerHTML = "";

    const stepsObj = licenseData[currentCategory][typeName];
    if (!stepsObj) {
        stepsModalBody.innerHTML = "<p>No steps available.</p>";
    } else {
        const steps = stepsObj[currentLang] || stepsObj.en; // fallback to English
        const ol = document.createElement("ol");
        ol.className = "list-group list-group-numbered";
        steps.forEach((step) => {
            const li = document.createElement("li");
            li.className = "list-group-item";
            li.textContent = step;
            ol.appendChild(li);
        });
        stepsModalBody.appendChild(ol);
    }

    stepsModal.show();
}

function printModalContent() {
    const printWindow = window.open("", "", "width=800,height=600");
    printWindow.document.write(`
        <html>
        <head>
            <title>${stepsModalLabel.textContent} - Steps</title>
            <style>
            body { font-family: Arial, sans-serif; padding: 20px; }
            h1 { color: #221d59; }
            ol { font-size: 1.1rem; }
            li { margin-bottom: 10px; }
            </style>
        </head>
        <body>
            <h1>${stepsModalLabel.textContent}</h1>
            ${stepsModalBody.innerHTML}
        </body>
        </html>
    `);
    printWindow.document.close();
    printWindow.focus();
    printWindow.print();
    // printWindow.close();
}

let currentCategory = null;

document.getElementById("btnDrivingLicense").addEventListener("click", () => {
    currentCategory = "driving";
    showTypeSelection("Driving License / رخصة قيادة", Object.keys(licenseData.driving));
});

document.getElementById("btnVehicleLicense").addEventListener("click", () => {
    currentCategory = "vehicle";
    showTypeSelection("Vehicle License / رخصة مركبة", Object.keys(licenseData.vehicle));
});

btnBackToCategory.addEventListener("click", () => {
    typeSelection.classList.add("d-none");
    categorySelection.classList.remove("d-none");
    currentCategory = null;
});

function goToHomePage() {
    window.location.href = "index.html";
}

btnBackToHome.addEventListener("click", goToHomePage);

printStepsBtn.addEventListener("click", printModalContent);

function showTypeSelection(title, types) {
    categorySelection.classList.add("d-none");
    typeSelection.classList.remove("d-none");
    typeSelectionTitle.textContent = title;
    clearTypeList();
    types.forEach((type) => {
        typeList.appendChild(createTypeCard(type));
    });
}